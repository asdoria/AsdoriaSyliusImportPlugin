parameters:
  asdoria_import.converter.path: "@@AsdoriaSyliusImportPlugin/Resources/config/converter/%s.yaml"

services:
    asdoria_import.serializer.abstract:
      abstract: true
      class: Asdoria\SyliusImportPlugin\Serializer\BaseSerializer
      calls:
        - [ setEntityManager, ['@doctrine.orm.default_entity_manager']]
        - [ setSerializerResolver, ['@asdoria_import.serializer_service_registry']]
        - [ setConverterPath, ['%asdoria_import.converter.path%']]
        - [ setKernel, ['@kernel']]

    asdoria_import.serializer.generic:
      parent: asdoria_import.serializer.abstract

    asdoria_import.serializer.customer:
      class: Asdoria\SyliusImportPlugin\Serializer\CustomerSerializer
      parent: asdoria_import.serializer.abstract
      tags:
        - { name: asdoria_import_serializer, type: 'App\Entity\Customer\Customer' }

    asdoria_import.serializer.shop_user:
      class: Asdoria\SyliusImportPlugin\Serializer\ShopUserSerializer
      parent: asdoria_import.serializer.abstract
      tags:
        - { name: asdoria_import_serializer, type: 'App\Entity\User\ShopUser' }
